<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sudoku Solver</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="light">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light px-3 fixed-top" role="navigation" aria-label="Main navigation">
    <a class="navbar-brand" href="#">Sudoku Solver</a>

    <!-- Theme toggle button with SVG icons and tooltip -->
    <button id="themeToggle"
            class="btn btn-outline-dark ms-auto d-flex align-items-center"
            type="button"
            aria-pressed="false"
            aria-label="Toggle dark mode"
            data-bs-toggle="tooltip"
            data-bs-placement="left"
            title="Toggle dark / light theme">
      <span id="themeIconWrapper" class="theme-icon-wrapper" aria-hidden="true">
        <!-- Moon (shown in light mode as the action to switch to dark) -->
        <svg id="icon-moon" class="theme-icon icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" fill="currentColor"/>
        </svg>
        <!-- Sun (shown in dark mode as the action to switch to light) -->
        <svg id="icon-sun" class="theme-icon icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M6.76 4.84l-1.8-1.79L3.17 4.84l1.79 1.8 1.8-1.8zM1 13h3v-2H1v2zm10-9h-2v3h2V4zm7.03 1.05l1.79-1.8-1.79-1.79-1.79 1.79 1.79 1.8zM20 11v2h3v-2h-3zM12 20h2v3h-2v-3zm4.24-1.76l1.8 1.79 1.79-1.79-1.79-1.8-1.8 1.8zM4.22 18.36l1.79 1.79 1.8-1.79-1.8-1.8-1.79 1.8z" fill="currentColor"/>
          <circle cx="12" cy="12" r="3" fill="currentColor"/>
        </svg>
      </span>
      <span id="themeText" class="ms-2">Dark Mode</span>
    </button>
  </nav>

  <div class="container mt-5 pt-5">
    <h2 class="text-center mb-4">Sudoku Solver</h2>

    <div class="row mb-4">
      <!-- Upload Sudoku Image -->
      <div class="col-md-6 text-center mb-3">
        <h5>Upload Sudoku Image</h5>
        <form id="uploadForm" method="POST" enctype="multipart/form-data" class="d-flex flex-column align-items-center">
          <input id="sudokuFile" type="file" class="form-control mb-2" name="sudoku_image" accept="image/png, image/jpeg, image/jpg" aria-label="Upload sudoku image">
          <button id="solveImageBtn" type="submit" class="btn btn-warning">Solve Image</button>
        </form>
      </div>

      <!-- Manual Grid -->
      <div class="col-md-6 text-center">
        <h5>Or Fill Manually</h5>

        <table id="sudoku-grid" role="grid" aria-label="Sudoku grid" class="mx-auto">
          {% for i in range(9) %}
          <tr role="row">
            {% for j in range(9) %}
            <td role="gridcell">
              <input
                id="cell-{{ i }}-{{ j }}"
                name="cell-{{ i }}-{{ j }}"
                type="text"
                maxlength="1"
                inputmode="numeric"
                pattern="[1-9]"
                aria-label="Row {{ i + 1 }} column {{ j + 1 }}"
                tabindex="{{ i * 9 + j + 1 }}"
              >
            </td>
            {% endfor %}
          </tr>
          {% endfor %}
        </table>

        <div class="mt-2 d-flex justify-content-center align-items-center flex-wrap gap-2">
          <button id="startSolveBtn" class="btn btn-success" type="button">Play</button>
          <button id="pauseSolveBtn" class="btn btn-warning" type="button">Pause</button>
          <button id="resetGridBtn" class="btn btn-secondary" type="button">Reset</button>
          <label for="speedRange" class="ms-2 mb-0">Speed:</label>
          <input type="range" id="speedRange" min="20" max="500" value="80" class="mx-1" aria-label="Animation speed">
        </div>
      </div>
    </div>

    <!-- Solved Output -->
    {% if solved_image %}
    <div class="text-center mt-4">
      <h3>Solved Sudoku</h3>
      <img id="solvedImage" src="{{ solved_image }}" class="img-fluid border rounded mt-3 solved-fade" alt="Solved sudoku image">
    </div>
    {% endif %}

    <div id="statusRegion" class="mt-3" aria-live="polite">
      {% if error %}
      <div class="alert alert-danger text-center" role="alert">{{ error }}</div>
      {% endif %}
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
